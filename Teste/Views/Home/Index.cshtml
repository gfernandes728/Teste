@model Teste.Models.ViewModels.AgrupadoresViewModels

<link rel="stylesheet" href="~/css/home.css" />

@{
    ViewData["Title"] = "Home Page";
}

@using (Html.BeginForm("Index", "Home", null, FormMethod.Post, false, new { @enctype = "mutipart/form-data", @id = "form-lista", @name = "form-lista" }))
{
    @Html.AntiForgeryToken()

    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-primary">
                <div class="panel-heading text-center">
                    <h2 class="text-warning">Agrupadores</h2>
                </div>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-lg-3">
                        <label>Dados Selecionados</label>
                        @Html.ListBoxFor(m => m.DadosSelecionados, Model.Dados, new { @class = "form-control", multiple = "multiple" })
                    </div>
                    <div class="col-lg-3">
                        <input type="submit" class="btn btn-primary" value="Gerar Relatorio">
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<label class="text-danger">@Model.Resultado</label>

@if (Model.Agrupadores != null && Model.Agrupadores.Any())
{
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-primary">
                <div class="panel-heading text-center">
                    <h2 class="text-warning">Relatorio</h2>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered table-striped table-hover">
                    <thead>
                        <tr>
                            @foreach (var dado in Model.DadosSelecionados)
                            {
                                <th>
                                    @Model.Dados.FirstOrDefault(x => x.Value == dado)?.Text
                                </th>
                            }
                            <th class="green-column">
                                QTD
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Agrupadores)
                        {
                            <tr>
                                @foreach (var dado in Model.DadosSelecionados)
                                {
                                    @if (dado == "t2.Agrupador1")
                                    {
                                        <td>@item.Agrupador1</td>
                                    }
                                    else if (dado == "t2.Agrupador2")
                                    {
                                        <td>@item.Agrupador2</td>
                                    }
                                    else if (dado == "t2.Agrupador3")
                                    {
                                        <td>@item.Agrupador3</td>
                                    }
                                    else if (dado == "t2.Agrupador4")
                                    {
                                        <td>@item.Agrupador4</td>
                                    }
                                    else if (dado == "t2.Agrupador5")
                                    {
                                        <td>@item.Agrupador5</td>
                                    }
                                    else if (dado == "t2.Agrupador6")
                                    {
                                        <td>@item.Agrupador6</td>
                                    }
                                    else if (dado == "t2.Agrupador7")
                                    {
                                        <td>@item.Agrupador7</td>
                                    }
                                    else if (dado == "t2.Agrupador8")
                                    {
                                        <td>@item.Agrupador8</td>
                                    }
                                    else if (dado == "t2.Agrupador9")
                                    {
                                        <td>@item.Agrupador9</td>
                                    }
                                    else if (dado == "t2.Agrupador10")
                                    {
                                        <td>@item.Agrupador10</td>
                                    }
                                    else if (dado == "t1.UsuarioID")
                                    {
                                        <td>@item.UsuarioID</td>
                                    }
                                    else if (dado == "t3.Nome")
                                    {
                                        <td>@item.Nome</td>
                                    }
                                    else if (dado == "t3.Valor")
                                    {
                                        <td>@item.Valor</td>
                                    }
                                }
                                <td class="green-column">@item.Qtd</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}